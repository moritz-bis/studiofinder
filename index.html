<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>studio-finder</title>

  <link rel="stylesheet" href="style.css">

</head>


<body>
  <h1>studio-finder</h1>

  <select id="countryFilter">
    <option value="all">all countries</option>
    <option value="DE">Germany</option>
    <option value="IT">Italy</option>
    <option value="INT">International</option>
  </select>

  <select id="cityFilter">
    <option value="all">Alle Städte</option>
    <option value="Berlin">Berlin</option>
    <option value="Munich">Munich</option>
    <option value="Rome">Milan</option>
  </select>

  <h2>Alle Studios</h2>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Website</th>
        <th>Stadt</th>
        <th>Tags</th>
        <th>Land</th> <!-- NEU -->
      </tr>
    </thead>
    <tbody id="all-studios"></tbody>
  </table>


  
<script>
  let alleStudios = []; // global, damit Filter Zugriff hat

  async function studiosTable() {
    const dateien = [
      'studiosDE.json',
      'studiosIT.json',
      'studiosINT.json'
    ];

    const alle = [];

    for (const dateiname of dateien) {
      try {
        const response = await fetch(dateiname);
        const daten = await response.json();
        alle.push(...daten); // korrekt: daten in alle pushen
      } catch (error) {
        console.error(`Fehler beim Laden von ${dateiname}:`, error);
      }
    }

    alleStudios = alle; // global verfügbar machen
    zeigeStudios(alleStudios); // initial anzeigen
  }

  function zeigeStudios(studios) {
    const tbody = document.getElementById('all-studios');
    tbody.innerHTML = ''; // vorherige Einträge löschen

    studios.sort((a, b) => a.name.localeCompare(b.name)); // alphabetisch

    studios.forEach(studio => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${studio.name}</td>
        <td><a href="${studio.website}" target="_blank">${studio.website}</a></td>
        <td>${studio.city}</td>
        <td>${studio.tags.join(', ')}</td>
        <td>${studio.country}</td>
      `;
      tbody.appendChild(row);
    });
  }

  // Filter
  function applyFilter() {
    const land = document.getElementById('countryFilter').value;
    const stadt = document.getElementById('cityFilter').value;

    let gefiltert = alleStudios;

    if (land !== 'all') {
      gefiltert = gefiltert.filter(s => s.country === land);
    }

    if (stadt !== 'all') {
      gefiltert = gefiltert.filter(s => s.city === stadt);
    }

    zeigeStudios(gefiltert);
  }

  document.getElementById('countryFilter').addEventListener('change', applyFilter);
  document.getElementById('cityFilter').addEventListener('change', applyFilter);

  // Start
  studiosTable();
</script>

</body>
</html>